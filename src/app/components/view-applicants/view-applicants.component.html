<div class="page-wrap">

    <!-- page header row -->
    <div class="page-bar">
        <h1 class="page-title">View Applicants</h1>

        <!-- Filters (right, compact) -->
        <div class="filters-row" [formGroup]="filtersForm">
            <span class="filters-label">Filters:</span>
        
            <!-- Skills -->
            <div class="position-relative filter-compact">
                <select class="form-select wf-select" formControlName="skillId">
                    <option [ngValue]="null" selected>Skills</option>
                    <option *ngFor="let s of skillsList" [ngValue]="s.skillId">
                        {{ s.skillName }}
                    </option>
                </select>
                <span class="wf-chev" aria-hidden="true">▾</span>
                <!-- Optional required star -->
                <!-- <span class="text-danger position-absolute required-star">*</span> -->
            </div>
        
            <!-- Country -->
            <div class="position-relative filter-compact">
                <select class="form-select wf-select" formControlName="country" (change)="onFiltersChanged()">
                    <option [ngValue]="null" selected>Country</option>
                    <option *ngFor="let co of countries" [ngValue]="co">{{ co.countryName }}</option>
                </select>
                <span class="wf-chev" aria-hidden="true">▾</span>
            </div>

            <!-- City -->
            <div class="position-relative filter-compact">
                <select class="form-select wf-select" formControlName="city" (mousedown)="CityDropdownOpen($event)">
                    <option [ngValue]="null" selected>City</option>
                    <option *ngFor="let c of cities" [ngValue]="c.cityName">{{ c.cityName }}</option>
                </select>
                <span class="wf-chev" aria-hidden="true">▾</span>
            </div>
        
            <!-- Search icon -->
            <button mat-icon-button class="filter-search-btn"  (click)="applyFilterFromControls()">
                <mat-icon>search</mat-icon>
            </button>
        </div>
    </div>

    <div class="card">
        <table class="jobs-table" mat-table [dataSource]="dataSource" matSort (matSortChange)="tableSortChange($event)"
            matSortDisableClear style="background-color: #fff;">
            <!-- Name -->
            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort">
                    <span class="cell-strong">Name</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.userName }}</td>
            </ng-container>

            <!-- Email -->
            <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort">
                    <span class="cell-strong">Email</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.email }}</td>
            </ng-container>

            <!-- City -->
            <ng-container matColumnDef="city">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort">
                    <span class="cell-strong">City</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.city }}</td>
            </ng-container>


            <!-- Country -->
            <ng-container matColumnDef="country">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort">
                    <span class="cell-strong">Country</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.country }}</td>
            </ng-container>

            <!-- Phone Number -->
            <ng-container matColumnDef="phone">
                <th mat-header-cell *matHeaderCellDef>
                    <span class="cell-strong">Phone Number</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.phone }}</td>
            </ng-container>

            <!-- Resume -->
            <ng-container matColumnDef="resume">
                <th mat-header-cell *matHeaderCellDef>
                    <span class="cell-strong">Resume</span>
                </th>
                <td mat-cell *matCellDef="let row">{{ row.resume }}</td>
                <i class="bi bi-cloud-arrow-down"></i>
            </ng-container>

            <!-- Actions -->
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef>
                    <span class="cell-strong">Actions</span>
                </th>
                <td mat-cell *matCellDef="let row" class="actions">
                    <button mat-icon-button matTooltip="View">
                        <i class="bi bi-eye"></i>
                    </button>
                    <button mat-icon-button matTooltip="Chat">
                        <i class="bi bi-chat-square-text"></i>
                    </button>
                    <button mat-icon-button matTooltip="Call">
                        <i class="bi bi-camera-video"></i>
                    </button>
                </td>
            </ng-container>

            <!-- header & rows -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="sticky"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="getPagingSizeIntervals()" showFirstLastButtons [length]="totalCount"
            [pageSize]="dataTable.pageSize" [pageIndex]="dataTable.pageIndex" (page)="handlePage($event)">
        </mat-paginator>

    </div>
</div>